
\ProvidesPackage{template/swunthesis-new}


% 引入基本宏包
% ==============================================================================
%

\usepackage{indentfirst}   % 使得每章第一段中文缩进
\usepackage{color}
\usepackage[dvipsnames]{xcolor}

% 数学相关
\usepackage{amsmath}       % 重要的数学环境
\usepackage{wasysym}       % 积分等特殊符号

% 图片相关
\usepackage{float}         % 图片表格浮动
\usepackage{subfigure}     % 子图
\usepackage{tikz}          % 绘图宏包, 注意, 此宏包必须在 xcolor 后使用
\usepackage{graphicx}      % 扩展 eps 图片支持
\usepackage{caption}
\renewcommand{\thefigure}{\thechapter-\arabic{figure}}
\captionsetup[figure]{labelsep=space}
\DeclareCaptionFont{bfsize}{\heiti \zihao{5}} % 设置图片标题字体
\captionsetup[figure]{font=bfsize}

% 表格相关
\usepackage{csvsimple}     % 通过 csv 数据创建表格
\usepackage{booktabs}      % 创建没有竖线分割的表格
\renewcommand{\thetable}{\thechapter-\arabic{table}}
\captionsetup[table]{labelsep=space}
\DeclareCaptionFont{bfsize}{\heiti \zihao{5}} % 设置表格标题字体
\captionsetup[table]{font=bfsize}
% 算法、代码相关
\usepackage{listings}      % 提供代码插入环境
\usepackage{algorithm}     % 提供算法浮动环境
\usepackage{algorithmic}   % 提供算法描述环境

% 文献相关
%\usepackage[toc]{appendix} % 提供附录环境，暂时用不到
\usepackage{cite}          % 文献引用，支持连续引用

% 定义代码样式
% ==============================================================================
% 目录相关
\usepackage{titletoc}
% 重新定义目录样式
 % 设置章节目录样式为小四号黑体
\titlecontents{chapter}[0em]{\zihao{-4}\heiti}{\contentslabel{3em}\hspace{1em}}{}{\titlerule*[8pt]{.}\contentspage}
% 设置节目录样式为小四号宋体
\titlecontents{section}[2em]{\zihao{-4}\songti}{\contentslabel{2.5em}}{}{\titlerule*[8pt]{.}\contentspage} 
% 设置小节目录样式为小四号宋体
\titlecontents{subsection}[4.5em]{\zihao{-4}\songti}{\contentslabel{3em}}{}{\titlerule*[8pt]{.}\contentspage} 
%===============================================================================

% \usepackage{xcolor}

\usepackage[CJKbookmarks=true,pdfborder=0 0 1]{hyperref}

\definecolor{keyword}{HTML}{BA2CA3}
\definecolor{string}{HTML}{D12F1B}
\definecolor{comment}{HTML}{008400}
\lstdefinelanguage{JavaScript}{
  keywords={typeof, new, true, false, catch, function, return, null, catch, switch, var, if, in, while, do, else, case, break},
  ndkeywords={class, export, boolean, throw, implements, import, this},
  ndkeywordstyle=\color{darkgray}\bfseries,
  identifierstyle=\color{black},
  sensitive=false,
  comment=[l]{//},
  morecomment=[s]{/*}{*/},
  keywordstyle=\color{blue}\bfseries,
  commentstyle=\color{gray}\ttfamily,
  stringstyle=\color{green!50!yellow}\ttfamily,
  morestring=[b]',
  morestring=[b]"
}
\lstdefinelanguage{Swift}{
  keywords={
    func,if,then,else,for,in,while,do,switch,case,default,where,break,continue,fallthrough,return,
    typealias,struct,class,enum,protocol,var,func,let,get,set,willSet,didSet,inout,init,deinit,extension,
    subscript,prefix,operator,infix,postfix,precedence,associativity,left,right,none,convenience,dynamic,
    final,lazy,mutating,nonmutating,optional,override,required,static,unowned,safe,weak,internal,
    private,public,is,as,self,unsafe,dynamicType,true,false,nil,Type,Protocol,
  },
  comment=[l]{//}, % l is for line comment
  morecomment=[s]{/*}{*/}, % s is for start and end delimiter
  morestring=[b]", % defines that strings are enclosed in double quotes
  keywordstyle=\color{keyword},
  commentstyle=\color{gray}\ttfamily,
  stringstyle=\color{green!50!yellow}\ttfamily,
}

\lstset{
  basicstyle={\small\ttfamily},
  keywordstyle={\bfseries\color{NavyBlue}},
  breaklines=true,
  emphstyle={\bfseries\color{Rhodamine}},
  commentstyle={\color{PineGreen!60!black}},
  stringstyle={\rmfamily\color{YellowOrange}},
  showstringspaces=false,
  frame=shadowbox,
  breakatwhitespace=false,
  captionpos=b,
  extendedchars=true,
  keepspaces=true,
  numbers=left,
  numberstyle=\tiny,
  rulecolor=\color{black},
  rulesepcolor={\color{blue!20!white}},
  showspaces=false,
}
\renewcommand{\lstlistingname}{代码片段}    % 将插入的代码从 Listing 1.1 变为 代码片段 1.1

% 提供定理环境
% ==============================================================================
%
% \newtheorem{definition}{定义}[section]
% \newtheorem{theorem}{定理}[section]
% \newtheorem{lemma}[theorem]{引理}
% \newtheorem{corollary}[theorem]{推论}


% 定义基础变量
% ==============================================================================
% 论文标题, thesis title
\newcommand{\titleValue}{}
\renewcommand{\title}[1]{\renewcommand{\titleValue}{#1}}
\newcommand{\entitleValue}{}
\newcommand{\entitle}[1]{\renewcommand{\entitleValue}{#1}}

% \renewcommand{\title}[1]{#1}

% 论文作者, tiesis author
\newcommand{\varAuthor}{}
\renewcommand{\author}[1]{\renewcommand{\varAuthor}{#1}}
\newcommand{\varAuthorEng}{}
\newcommand{\enauthor}[1]{\renewcommand{\varAuthorEng}{#1}}

% 论文日期, thesis date
\newcommand{\varDate}{}
\renewcommand{\date}[1]{\renewcommand{\varDate}{#1}}

% 论文导师, thesis adviser
\newcommand{\varAdviser}{}
\newcommand{\adviser}[1]{\renewcommand{\varAdviser}{#1}}
\newcommand{\varAdviserEng}{}
\newcommand{\enadviser}[1]{\renewcommand{\varAdviserEng}{#1}}
\newcommand{\advTitle}{}
\newcommand{\advtitle}[1]{\renewcommand{\advTitle}{#1}}

% 论文联合导师, co-adviser support
\newcommand{\varCoAdviser}{}
\newcommand{\coadviser}[1]{\renewcommand{\varCoAdviser}{#1}}
\newcommand{\varCoAdviserEng}{}
\newcommand{\encoadviser}[1]{\renewcommand{\varCoAdviserEng}{#1}}
\newcommand{\coadvTitle}{}
\newcommand{\coadvtitle}[1]{\renewcommand{\coadvTitle}{#1}}

% 学院名称, college name
\newcommand{\varCollege}{}
\newcommand{\college}[1]{\renewcommand{\varCollege}{#1}}
\newcommand{\varCollegeEng}{}
\newcommand{\encollege}[1]{\renewcommand{\varCollegeEng}{#1}}

% 专业名称, major name
\newcommand{\varMajor}{}
\newcommand{\major}[1]{\renewcommand{\varMajor}{#1}}
\newcommand{\varMajorEng}{}
\newcommand{\enmajor}[1]{\renewcommand{\varMajorEng}{#1}}

% 学号, student number
\newcommand{\varID}{}
\newcommand{\id}[1]{\renewcommand{\varID}{#1}}

% 年级, grade
\newcommand{\varGrade}{}
\newcommand{\grade}[1]{\renewcommand{\varGrade}{#1}}

% 摘要关键词, keyworkds
\newcommand{\varKeyword}{}
\newcommand{\keyword}[1]{\renewcommand{\varKeyword}{#1}}

% 自定义摘要环境
% ==============================================================================
\renewenvironment{abstract}[1]{
    \addtolength{\leftskip}{0.4cm}
    \addtolength{\rightskip}{0.4cm}
    \vspace*{0.2cm}
    \centerline{\heiti \zihao{-2} {摘要}}
    \setcounter{page}{1}
    \vspace{0.5cm}
    \songti \zihao{-4}
    \keyword{#1}
    \fancyfoot[C]{\Roman{page}} % 在页脚中间显示大写罗马数字页码
    \pagestyle{fancy}
}{
    \\\par \textbf{关键词： }\ \varKeyword
    \thispagestyle{fancy} % 添加页脚
    \newpage % 手动换页
}
\newenvironment{abstractEng}[1]{
    \addtolength{\leftskip}{0.4cm}
    \addtolength{\rightskip}{0.4cm}
    \vspace*{0.5cm}
    \centerline{\heiti \zihao{-2} \textbf{Abstract}}
    \vspace{0.5cm}
    \zihao{-4}
    \keyword{#1}
    \fancyfoot[C]{\Roman{page}} % 在页脚中间显示大写罗马数字页码
    \pagestyle{fancy}
}{
    \\\par \textbf{Keywords: } \varKeyword
    \thispagestyle{fancy} % 添加页脚
    \newpage % 手动换页
}

% 自定义封面封面环境
% ==============================================================================
%
\usepackage{array} %
\newcommand{\makecover}{
    \thispagestyle{empty}
    \addtocounter{page}{0}
    \vspace*{1cm}
    \centerline{\includegraphics[height=1.6cm]{./template/title}}
    \vspace*{1.2cm}
    \centerline{\songti\zihao{-2}本~~科~~生~~毕~~业~~论~~文(设~~计)} % skip bold, it's a hack and i dont know why
    \vspace*{2cm}
    \centerline{\songti \zihao{-2} \textbf{题目：\titleValue}}
    \centerline{\songti~}
    \centerline{\zihao{-4} \bfseries \entitleValue}
    \vspace*{4.0cm}
    \centerline{
    \begin{tabular}{ b{3cm} >{\centering\arraybackslash}b{7cm}}
    \songti \zihao{3} 教学单位 & {\songti \zihao{3} \varCollege} \\[-3pt]
    \cline{2-2} \\[0.1cm]
    \songti \zihao{3} 姓\hspace{1cm}名 & {\songti \zihao{3} \varAuthor} \\[-3pt]
    \cline{2-2} \\[0.1cm]
    \songti \zihao{3} 学\hspace{1cm}号 & {\songti \zihao{3} \varID} \\[-3pt]
    \cline{2-2} \\[0.1cm]
    \songti \zihao{3} 年\hspace{1cm}级 & {\songti \zihao{3} \varGrade} \\[-3pt]
    \cline{2-2} \\[0.1cm]
    \songti \zihao{3} 专\hspace{1cm}业 & {\songti \zihao{3} \varMajor} \\[-3pt]
    \cline{2-2} \\[0.1cm]
    \songti \zihao{3} 导\hspace{1cm}师 & {\songti \zihao{3} \varAdviser} \\[-3pt]
    \cline{2-2} \\[0.1cm]
    \songti \zihao{3} 职\hspace{1cm}称 & {\songti \zihao{3} \advTitle} \\[-3pt]
    \cline{2-2} \\[0.1cm]
    % \songti \zihao{4} 联合导师 & {\kaishu \zihao{4} \varCoAdviser} \\[-3pt]
    % \cline{2-2} \\[0.1cm]
    % \songti \zihao{4} 职\hspace{1cm}称 & {\kaishu \zihao{4} \coadvTitle} \\[-3pt]
    % \cline{2-2} \\[0.1cm]
    \end{tabular}
    }
    \vfill
    \centerline{\songti \zihao{4}\varDate}
    \clearpage
    ~~\thispagestyle{empty}
    \clearpage
    \setcounter{page}{1}
    \tableofcontents
    \cleardoublepage
}

%
% 自定义页面边距
% ==============================================================================
%
\usepackage{geometry}
\geometry{
    top=2.5cm,              % 根据需求调整这个
    headheight=0.5cm,       % 这个
    headsep=0.5cm,          % 还有这个
    inner=2.5cm,
    outer=2cm,
    bottom=2.5cm,
}

% 自定义行间距
% ==============================================================================
%
\usepackage{setspace}
\linespread{1.5}          % 经验值, 不建议修改
% \setlength{\baselineskip}{25pt} % 行间距固定 20 磅, 但影响排版美观

%
% 自定义页眉环境
% ==============================================================================
\usepackage{fancyhdr}
\pagestyle{fancy}
\fancyhf{}
\chead{\textcolor[gray]{0.5}{\zihao{-4} \titleValue}}


% 自定义 CTEX 样式
% ==============================================================================
%
\ctexset{today=small}

%setup page counter
\setcounter{tocdepth}{3}
\setcounter{secnumdepth}{3}

% 设置 chapter 格式
\fancypagestyle{plain}{}  % let the chapter pages display headers
\ctexset{ chapter = { beforeskip={-10pt} } }
\ctexset{ chapter = { afterskip={10pt} } }
\ctexset{ chapter = { name={第,章} } }       % 可以通过该行定制为『第*章』形式
%\ctexset{ chapter = { name={} } }
\ctexset{ chapter = { format={\centering}}}
\ctexset{ chapter = { number={\arabic{chapter}} }}
\ctexset{ chapter = { nameformat={\zihao{-2} \bfseries \heiti} }}
\ctexset{ chapter = { titleformat={\zihao{-2} \bfseries \heiti} }}

% 设置 section 格式
\ctexset{ section = { beforeskip={10pt} }}
\ctexset{ section = { afterskip={5pt} }}
\ctexset{ section = { format={\raggedright} }}
\ctexset{ section = { nameformat={\zihao{-3}  \heiti} }}
\ctexset{ section = { titleformat={\zihao{-3} \heiti} }}

% 设置 subsection 格式
\ctexset{ subsection = { beforeskip={5pt} }}
\ctexset{ subsection = { afterskip={1pt} }}
\ctexset{ subsection = { format={\raggedright} }}
\ctexset{ subsection = { nameformat={\zihao{4}  \heiti} }}
\ctexset{ subsection = { titleformat={\zihao{4} \heiti} }}

% 设置 subsubsection 格式
\ctexset{ subsubsection = { beforeskip={0pt} }}
\ctexset{ subsubsection = { afterskip={1pt} }}
\ctexset{ subsubsection = { format={\raggedright} }}
\ctexset{ subsubsection = { nameformat={\zihao{-4}  \heiti} }}
\ctexset{ subsubsection = { titleformat={\zihao{-4} \heiti} }}

% 设置中文字体集为 Adobe 开源字体系列
%\ctexset{ fontset = adobe }
% 设置英文字体为 Times New Roman
\usepackage{fontspec}
\setmainfont{Times New Roman}
